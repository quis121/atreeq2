<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø¹Ø§Ù„Ø·Ø±ÙŠÙ‚ â€“ Ø±Ø­Ù„ØªÙƒ ØªØ¨Ø¯Ø£ Ù‡Ù†Ø§</title>
  <link rel="stylesheet" href="e2.css" />
  <style>
    body { font-family: 'Cairo', Arial, sans-serif; background: #f7f7fa; margin: 0; }
    header { background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.04); padding: 15px 0 10px 0; position: relative; }
    .logo { display: flex; align-items: center; gap: 10px; font-size: 22px; font-weight: bold; color: #007bff; margin-right: 30px; }
    .logo img { width: 40px; height: 40px; border-radius: 50%; }
    nav { display: inline-block; margin-right: 30px; }
    nav a { color: #333; text-decoration: none; margin: 0 10px; font-weight: 500; }
    nav a:hover { color: #007bff; }
    .lang-switch { margin-left: 20px; display: inline-block; vertical-align: middle; }
    .lang-switch button { margin-left: 3px; background: #eee; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; }
    .lang-switch button:hover { background: #007bff; color: #fff; }
    .profile-icon { position: absolute; top: 15px; left: 15px; cursor: pointer; font-size: 22px; font-weight: bold; color: #333; display: none; z-index: 1001; }
    .profile-icon:hover { color: #007bff; }
    #profile-dropdown { display: none; position: absolute; top: 45px; left: 15px; background: white; border: 1px solid #ddd; border-radius: 5px; min-width: 120px; box-shadow: 0 2px 8px rgba(0,0,0,0.15); z-index: 1002; direction: rtl; font-size: 14px; }
    #profile-dropdown button { width: 100%; padding: 10px; border: none; background: transparent; cursor: pointer; text-align: right; color: #333; border-radius: 0; outline: none; }
    #profile-dropdown button:hover { background-color: #007bff; color: white; }
    main { max-width: 900px; margin: 30px auto 0 auto; background: #fff; border-radius: 10px; box-shadow: 0 2px 16px rgba(0,0,0,0.06); padding: 30px 20px; }
    .hero { text-align: center; margin-bottom: 40px; }
    .hero h1 { font-size: 2.2em; color: #007bff; margin-bottom: 10px; }
    .hero p { color: #444; margin-bottom: 20px; }
    .btn-group { margin: 20px 0; }
    .btn { padding: 10px 22px; border: none; border-radius: 5px; font-size: 1em; cursor: pointer; margin: 0 5px; }
    .btn-primary { background: #007bff; color: #fff; }
    .btn-primary:hover { background: #0056b3; }
    .btn-secondary { background: #eee; color: #007bff; }
    .btn-secondary:hover { background: #007bff; color: #fff; }
    section { margin-bottom: 40px; }
    h2 { color: #007bff; margin-bottom: 10px; }
    .features-grid { display: flex; gap: 20px; flex-wrap: wrap; }
    .feature-card { background: #f1f7ff; border-radius: 8px; padding: 18px; flex: 1 1 200px; min-width: 180px; text-align: center; }
    .feature-icon { font-size: 2em; margin-bottom: 10px; }
    .steps-list { padding-right: 20px; }
    .steps-list li { margin-bottom: 8px; }
    footer { text-align: center; color: #888; padding: 18px 0 10px 0; background: #fff; border-top: 1px solid #eee; margin-top: 40px; }
    /* Modal Styles */
    .modal { display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);}
    .modal-content { background-color: #fff; margin: 5% auto; padding: 25px 20px; border-radius: 8px; width: 95%; max-width: 370px; direction: rtl; position: relative; }
    .close { color: #aaa; float: left; font-size: 28px; font-weight: bold; cursor: pointer; position: absolute; left: 15px; top: 10px;}
    .close:hover { color: black; }
    .form-group { margin-bottom: 18px; }
    .form-group label { display: block; margin-bottom: 6px; color: #007bff; font-weight: 500; }
    .form-group input, .form-group select { width: 100%; padding: 8px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 1em; }
    .form-group input:focus, .form-group select:focus { border-color: #007bff; outline: none; }
    #login-message { margin-top: 10px; font-weight: bold; color: green; word-break: break-word;}
    #login-step1, #login-step2, #login-email { margin-bottom: 10px; }
    #login-step2 { margin-top: 10px; }
    #login-email label { margin-top: 8px; }
    @media (max-width: 600px) {
      main { padding: 10px 2vw; }
      .features-grid { flex-direction: column; }
      .modal-content { width: 98vw; }
    }
  </style>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
</head>
<body>

  <header>
    <div class="profile-icon" id="profile-link" onclick="toggleProfileDropdown()">ğŸ‘¤</div>
    <div id="profile-dropdown" role="menu" aria-label="User menu">
      <button type="button" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>
    <div class="logo">
      <img src="https://i.ibb.co/y1BMpfC/Versatile-Circular-Logo-for-Ride-Hailing-App.png" alt="Ø¹Ø§Ù„Ø·Ø±ÙŠÙ‚" />
      <span>Ø¹Ø§Ù„Ø·Ø±ÙŠÙ‚</span>
    </div>
    <nav>
      <a href="#features" data-key="navFeatures">Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</a>
      <a href="#how-it-works" data-key="navHow">ÙƒÙŠÙ ÙŠØ¹Ù…Ù„</a>
      <a href="#pricing" data-key="navPricing">Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</a>
      <a href="#contact" data-key="navContact">Ø§ØªØµÙ„ Ø¨Ù†Ø§</a>
    </nav>
    <div class="lang-switch">
      <button onclick="switchLang('ar')">Ø¹Ø±Ø¨ÙŠ</button>
      <button onclick="switchLang('en')">English</button>
      <button onclick="switchLang('he')">×¢Ö´×‘×¨Ö´×™×ª</button>
    </div>
  </header>

  <main>
    <section class="hero">
      <h1 data-key="heading">Ø±Ø­Ù„ØªÙƒ ØªØ¨Ø¯Ø£ Ù‡Ù†Ø§</h1>
      <p data-key="subtext">Ø·Ù„Ø¨ ØªØ§ÙƒØ³ÙŠ Ø®Ø§Øµ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ³Ø±Ø¹Ø© Ù…Ø¹ Ø¹Ø§Ù„Ø·Ø±ÙŠÙ‚. Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø±Ø­Ù„Ø§Øª Ù…Ø±ÙŠØ­Ø© ÙˆØ¢Ù…Ù†Ø© Ù…Ø¹ Ø³Ø§Ø¦Ù‚ÙŠÙ† Ù…Ø­ØªØ±ÙÙŠÙ†.</p>
      <div class="btn-group">
        <button class="btn btn-primary" data-key="btnRequest" onclick="openBookingModal()">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
        <button id="login-btn" class="btn btn-secondary" data-key="btnLogin" onclick="openLoginModal()">ØªØ³Ø¬ÙŠÙ„ / Ø¯Ø®ÙˆÙ„</button>
      </div>
    </section>

    <section id="features">
      <h2 data-key="featuresTitle">Ù„Ù…Ø§Ø°Ø§ ØªØ®ØªØ§Ø± Ø¹Ø§Ù„Ø·Ø±ÙŠÙ‚ØŸ</h2>
      <p data-key="featuresSub">Ù†Ù‚Ø¯Ù… Ù„Ùƒ Ø£ÙØ¶Ù„ ØªØ¬Ø±Ø¨Ø© Ø­Ø¬Ø² Ø³ÙŠØ§Ø±Ø§Øª Ø®Ø§ØµØ©</p>
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">ğŸš•</div>
          <h3 data-key="feature1Title">Ø­Ø¬Ø² Ø³Ø±ÙŠØ¹</h3>
          <p data-key="feature1Text">Ø§Ø­Ø¬Ø² Ø±Ø­Ù„ØªÙƒ ÙÙŠ Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ğŸ“±</div>
          <h3 data-key="feature4Title">ØªØªØ¨Ø¹ Ù…Ø¨Ø§Ø´Ø±</h3>
          <p data-key="feature4Text">ØªØªØ¨Ø¹ Ù…ÙˆÙ‚Ø¹ Ø³ÙŠØ§Ø±ØªÙƒ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ</p>
        </div>
      </div>
    </section>

    <section id="how-it-works">
      <h2 data-key="howTitle">ÙƒÙŠÙ ØªØ¹Ù…Ù„ Ø§Ù„Ø®Ø¯Ù…Ø©ØŸ</h2>
      <p data-key="howSub">3 Ø®Ø·ÙˆØ§Øª Ø¨Ø³ÙŠØ·Ø© Ù„Ø±Ø­Ù„ØªÙƒ</p>
      <ol class="steps-list">
        <li data-key="step1">Ø§Ø®ØªØ± Ù†Ù‚Ø·Ø© Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚ ÙˆØ§Ù„ÙˆØ¬Ù‡Ø©</li>
        <li data-key="step2">Ø­Ø¯Ø¯ Ù†ÙˆØ¹ Ø§Ù„Ø±Ø­Ù„Ø©</li>
        <li data-key="step3">Ù‚Ù… Ø¨ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù†ØªØ¸Ø± Ø§Ù„Ø³Ø§Ø¦Ù‚</li>
      </ol>
    </section>

    <section id="pricing">
      <h2 data-key="pricingTitle">Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</h2>
      <p data-key="pricingSub">Ù†Ù‚Ø¯Ù… Ù„Ùƒ Ø£Ø³Ø¹Ø§Ø± Ù…Ù†Ø§Ø³Ø¨Ø© ÙˆÙ…Ù†Ø§ÙØ³Ø©</p>
      <p data-key="pricingNote">* Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù‚Ø¯ ØªØ®ØªÙ„Ù Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ© ÙˆØ§Ù„ÙˆÙ‚Øª.</p>
    </section>

    <section id="contact">
      <h2 data-key="navContact">Ø§ØªØµÙ„ Ø¨Ù†Ø§</h2>
      <p data-key="contactEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: alatariqhelp@gmail.com</p>
      <p data-key="contactPhone">Ø§Ù„Ù‡Ø§ØªÙ: 1234-5678-009</p>
    </section>
  </main>

  <footer>
    <span data-key="footer">Â© 2025 Ø¹Ø§Ù„Ø·Ø±ÙŠÙ‚. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</span>
  </footer>

  <!-- Booking Modal -->
  <div id="booking-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="bookingTitle">
    <div class="modal-content">
      <span class="close" onclick="closeBookingModal()" aria-label="Close booking modal">&times;</span>
      <h2 id="bookingTitle" data-key="bookRide">Ø­Ø¬Ø² Ø±Ø­Ù„Ø©</h2>
      <form id="booking-form">
        <div class="form-group">
          <label data-key="formPickup">Ù†Ù‚Ø·Ø© Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚</label>
          <input type="text" id="pickup-input" placeholder="Ù…Ø«Ø§Ù„: Ø´Ø§Ø±Ø¹ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©" required />
        </div>
        <div class="form-group">
          <label data-key="formDestination">Ø§Ù„ÙˆØ¬Ù‡Ø©</label>
          <input type="text" id="destination-input" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ø·Ø© Ø§Ù„Ù‚Ø·Ø§Ø±" required />
        </div>
        <div class="form-group">
          <label data-key="formRideType">Ù†ÙˆØ¹ Ø§Ù„Ø±Ø­Ù„Ø©</label>
          <select id="ride-type-input" required>
            <option value="" disabled selected data-key="formSelectOption">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø±Ø­Ù„Ø©</option>
            <option value="standard" data-key="formStandard">Ø¹Ø§Ø¯ÙŠ</option>
            <option value="premium" data-key="formPremium">Ù…Ù…ÙŠØ²</option>
            <option value="group" data-key="formGroup">Ù…Ø¬Ù…ÙˆØ¹Ø©</option>
          </select>
        </div>
        <button type="submit" class="btn btn-primary form-submit" data-key="formSubmit">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</button>
      </form>
    </div>
  </div>

  <!-- Login Modal -->
  <div id="login-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
    <div class="modal-content">
      <span class="close" onclick="closeLoginModal()" aria-label="Close login modal">&times;</span>
      <h2 id="loginTitle" data-key="loginTitle">ØªØ³Ø¬ÙŠÙ„ / Ø¯Ø®ÙˆÙ„</h2>
      <div id="login-step1">
        <label for="login-phone" data-key="loginPhoneLabel">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
        <input type="text" id="login-phone" placeholder="+1234567890" />
        <button class="btn btn-primary" onclick="requestLoginCode()" data-key="sendCodeBtn">Ø£Ø±Ø³Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
        <div id="recaptcha-container"></div>
      </div>
      <div id="login-step2" style="display:none; margin-top: 15px;">
        <label for="login-code" data-key="loginCodeLabel">Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚</label>
        <input type="text" id="login-code" maxlength="6" />
        <button class="btn btn-primary" onclick="verifyLoginCode()" data-key="verifyCodeBtn">ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù…Ø²</button>
      </div>
      <div id="login-email" style="margin-top:15px;">
        <label for="login-email-input">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
        <input type="email" id="login-email-input" placeholder="you@email.com" />
        <label for="login-password-input">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <input type="password" id="login-password-input" placeholder="******" />
        <button class="btn btn-primary" onclick="emailLogin()">Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯</button>
        <button class="btn btn-secondary" onclick="emailRegister()">ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>
      </div>
      <div id="login-message" role="alert" aria-live="polite"></div>
    </div>
  </div>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyA5n4AUu6fiopYykadLkqRjipxJjZsd6xs",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com", // Replace with your Firebase project info
      projectId: "YOUR_PROJECT_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);

    let confirmationResult = null;

    // Translations for Arabic, English, Hebrew
    const translations = {
      ar: {
        navFeatures: "Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª",
        navHow: "ÙƒÙŠÙ ÙŠØ¹Ù…Ù„",
        navPricing: "Ø§Ù„Ø£Ø³Ø¹Ø§Ø±",
        navContact: "Ø§ØªØµÙ„ Ø¨Ù†Ø§",
        heading: "Ø±Ø­Ù„ØªÙƒ ØªØ¨Ø¯Ø£ Ù‡Ù†Ø§",
        subtext: "Ø·Ù„Ø¨ ØªØ§ÙƒØ³ÙŠ Ø®Ø§Øµ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ³Ø±Ø¹Ø© Ù…Ø¹ Ø¹Ø§Ù„Ø·Ø±ÙŠÙ‚. Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø±Ø­Ù„Ø§Øª Ù…Ø±ÙŠØ­Ø© ÙˆØ¢Ù…Ù†Ø© Ù…Ø¹ Ø³Ø§Ø¦Ù‚ÙŠÙ† Ù…Ø­ØªØ±ÙÙŠÙ†.",
        btnRequest: "Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†",
        btnLogin: "ØªØ³Ø¬ÙŠÙ„ / Ø¯Ø®ÙˆÙ„",
        featuresTitle: "Ù„Ù…Ø§Ø°Ø§ ØªØ®ØªØ§Ø± Ø¹Ø§Ù„Ø·Ø±ÙŠÙ‚ØŸ",
        featuresSub: "Ù†Ù‚Ø¯Ù… Ù„Ùƒ Ø£ÙØ¶Ù„ ØªØ¬Ø±Ø¨Ø© Ø­Ø¬Ø² Ø³ÙŠØ§Ø±Ø§Øª Ø®Ø§ØµØ©",
        feature1Title: "Ø­Ø¬Ø² Ø³Ø±ÙŠØ¹",
        feature1Text: "Ø§Ø­Ø¬Ø² Ø±Ø­Ù„ØªÙƒ ÙÙŠ Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·",
        feature4Title: "ØªØªØ¨Ø¹ Ù…Ø¨Ø§Ø´Ø±",
        feature4Text: "ØªØªØ¨Ø¹ Ù…ÙˆÙ‚Ø¹ Ø³ÙŠØ§Ø±ØªÙƒ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ",
        howTitle: "ÙƒÙŠÙ ØªØ¹Ù…Ù„ Ø§Ù„Ø®Ø¯Ù…Ø©ØŸ",
        howSub: "3 Ø®Ø·ÙˆØ§Øª Ø¨Ø³ÙŠØ·Ø© Ù„Ø±Ø­Ù„ØªÙƒ",
        step1: "Ø§Ø®ØªØ± Ù†Ù‚Ø·Ø© Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚ ÙˆØ§Ù„ÙˆØ¬Ù‡Ø©",
        step2: "Ø­Ø¯Ø¯ Ù†ÙˆØ¹ Ø§Ù„Ø±Ø­Ù„Ø©",
        step3: "Ù‚Ù… Ø¨ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù†ØªØ¸Ø± Ø§Ù„Ø³Ø§Ø¦Ù‚",
        pricingTitle: "Ø§Ù„Ø£Ø³Ø¹Ø§Ø±",
        pricingSub: "Ù†Ù‚Ø¯Ù… Ù„Ùƒ Ø£Ø³Ø¹Ø§Ø± Ù…Ù†Ø§Ø³Ø¨Ø© ÙˆÙ…Ù†Ø§ÙØ³Ø©",
        pricingNote: "* Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù‚Ø¯ ØªØ®ØªÙ„Ù Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ© ÙˆØ§Ù„ÙˆÙ‚Øª.",
        contactEmail: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: support@alatariq.com",
        contactPhone: "Ø§Ù„Ù‡Ø§ØªÙ: 1234-5678-009",
        footer: "Â© 2025 Ø¹Ø§Ù„Ø·Ø±ÙŠÙ‚. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.",
        bookRide: "Ø­Ø¬Ø² Ø±Ø­Ù„Ø©",
        formPickup: "Ù†Ù‚Ø·Ø© Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚",
        formDestination: "Ø§Ù„ÙˆØ¬Ù‡Ø©",
        formRideType: "Ù†ÙˆØ¹ Ø§Ù„Ø±Ø­Ù„Ø©",
        formSelectOption: "Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø±Ø­Ù„Ø©",
        formStandard: "Ø¹Ø§Ø¯ÙŠ",
        formPremium: "Ù…Ù…ÙŠØ²",
        formGroup: "Ù…Ø¬Ù…ÙˆØ¹Ø©",
        formSubmit: "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²",
        loginTitle: "ØªØ³Ø¬ÙŠÙ„ / Ø¯Ø®ÙˆÙ„",
        loginPhoneLabel: "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ",
        sendCodeBtn: "Ø£Ø±Ø³Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨",
        loginCodeLabel: "Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚",
        verifyCodeBtn: "ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù…Ø²",
        loginCodeSent: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©.",
        loginSuccess: "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!",
        loginError: "Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
        loginInvalidCode: "Ø±Ù…Ø² ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©.",
        loginPhoneRequired: "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ.",
        loginCodeRequired: "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚."
      },
      en: {
        navFeatures: "Features",
        navHow: "How It Works",
        navPricing: "Pricing",
        navContact: "Contact Us",
        heading: "Your Journey Starts Here",
        subtext: "Order a private taxi easily and quickly with Al-Tariq. Enjoy comfortable and safe rides with professional drivers.",
        btnRequest: "Request Now",
        btnLogin: "Sign Up / Login",
        featuresTitle: "Why Choose Al-Tariq?",
        featuresSub: "We offer you the best private car booking experience",
        feature1Title: "Fast Booking",
        feature1Text: "Book your ride in less than one minute",
        feature4Title: "Live Tracking",
        feature4Text: "Track your car location in real-time",
        howTitle: "How the Service Works?",
        howSub: "3 simple steps for your ride",
        step1: "Choose pickup and destination points",
        step2: "Select the ride type",
        step3: "Confirm your booking and wait for the driver",
        pricingTitle: "Pricing",
        pricingSub: "We offer competitive and reasonable prices",
        pricingNote: "* Prices may vary according to distance and time.",
        contactEmail: "Email: support@alatariq.com",
        contactPhone: "Phone: 1234-5678-009",
        footer: "Â© 2025 Al-Tariq. All rights reserved.",
        bookRide: "Book a Ride",
        formPickup: "Pickup Point",
        formDestination: "Destination",
        formRideType: "Ride Type",
        formSelectOption: "Select a ride type",
        formStandard: "Standard",
        formPremium: "Premium",
        formGroup: "Group",
        formSubmit: "Confirm Booking",
        loginTitle: "Login / Sign Up",
        loginPhoneLabel: "Phone Number",
        sendCodeBtn: "Send Verification Code via WhatsApp",
        loginCodeLabel: "Enter Verification Code",
        verifyCodeBtn: "Verify Code",
        loginCodeSent: "Verification code sent via WhatsApp. Please check your messages.",
        loginSuccess: "Logged in successfully!",
        loginError: "An error occurred, please try again.",
        loginInvalidCode: "Invalid or expired code.",
        loginPhoneRequired: "Please enter your phone number.",
        loginCodeRequired: "Please enter the verification code."
      },
      he: {
        navFeatures: "×ª×›×•× ×•×ª",
        navHow: "××™×š ×–×” ×¢×•×‘×“",
        navPricing: "×ª××—×•×¨",
        navContact: "×¦×•×¨ ×§×©×¨",
        heading: "×”××¡×¢ ×©×œ×š ××ª×—×™×œ ×›××Ÿ",
        subtext: "×”×–××Ÿ ××•× ×™×ª ×¤×¨×˜×™×ª ×‘×§×œ×•×ª ×•×‘××”×™×¨×•×ª ×¢× ××œ-×ª××¨×™×§. ×ª×”× ×” ×× ×¡×™×¢×•×ª × ×•×—×•×ª ×•×‘×˜×•×—×•×ª ×¢× × ×”×’×™× ××§×¦×•×¢×™×™×.",
        btnRequest: "×”×–××Ÿ ×¢×›×©×™×•",
        btnLogin: "×”×¨×©××” / ×”×ª×—×‘×¨×•×ª",
        featuresTitle: "×œ××” ×œ×‘×—×•×¨ ×‘××œ-×ª××¨×™×§?",
        featuresSub: "×× ×• ××¦×™×¢×™× ×œ×š ××ª ×—×•×•×™×ª ×”×”×–×× ×” ×”×˜×•×‘×” ×‘×™×•×ª×¨",
        feature1Title: "×”×–×× ×” ××”×™×¨×”",
        feature1Text: "×”×–××Ÿ ××ª ×”× ×¡×™×¢×” ×©×œ×š ×‘×¤×—×•×ª ××“×§×”",
        feature4Title: "××¢×§×‘ ×—×™",
        feature4Text: "×¢×§×•×‘ ××—×¨×™ ××™×§×•× ×”×¨×›×‘ ×©×œ×š ×‘×–××Ÿ ×××ª",
        howTitle: "××™×š ×”×©×™×¨×•×ª ×¢×•×‘×“?",
        howSub: "3 ×©×œ×‘×™× ×¤×©×•×˜×™× ×œ× ×¡×™×¢×” ×©×œ×š",
        step1: "×‘×—×¨ × ×§×•×“×ª ×”×ª×—×œ×” ×•×™×¢×“",
        step2: "×‘×—×¨ ×¡×•×’ × ×¡×™×¢×”",
        step3: "××©×¨ ××ª ×”×”×–×× ×” ×•×”××ª×Ÿ ×œ× ×”×’",
        pricingTitle: "×ª××—×•×¨",
        pricingSub: "×× ×• ××¦×™×¢×™× ××—×™×¨×™× ×ª×—×¨×•×ª×™×™× ×•×”×•×’× ×™×",
        pricingNote: "* ×”××—×™×¨×™× ×¢×©×•×™×™× ×œ×”×©×ª× ×•×ª ×‘×”×ª×× ×œ××¨×—×§ ×•×œ×–××Ÿ.",
        contactEmail: "××™××™×™×œ: support@alatariq.com",
        contactPhone: "×˜×œ×¤×•×Ÿ: 1234-5678-009",
        footer: "Â© 2025 ××œ-×ª××¨×™×§. ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª.",
        bookRide: "×”×–××Ÿ × ×¡×™×¢×”",
        formPickup: "× ×§×•×“×ª ×”×ª×—×œ×”",
        formDestination: "×™×¢×“",
        formRideType: "×¡×•×’ × ×¡×™×¢×”",
        formSelectOption: "×‘×—×¨ ×¡×•×’ × ×¡×™×¢×”",
        formStandard: "×¡×˜× ×“×¨×˜",
        formPremium: "×¤×¨×™××™×•×",
        formGroup: "×§×‘×•×¦×”",
        formSubmit: "××™×©×•×¨ ×”×–×× ×”",
        loginTitle: "×”×ª×—×‘×¨×•×ª / ×”×¨×©××”",
        loginPhoneLabel: "××¡×¤×¨ ×˜×œ×¤×•×Ÿ",
        sendCodeBtn: "×©×œ×— ×§×•×“ ××™××•×ª ×‘×•×•××˜×¡××¤",
        loginCodeLabel: "×”×–×Ÿ ×§×•×“ ××™××•×ª",
        verifyCodeBtn: "×××ª ×§×•×“",
        loginCodeSent: "×§×•×“ ×”××™××•×ª × ×©×œ×— ×‘×•×•××˜×¡××¤. ×× × ×‘×“×•×§ ××ª ×”×”×•×“×¢×”.",
        loginSuccess: "×”×ª×—×‘×¨×ª ×‘×”×¦×œ×—×”!",
        loginError: "××™×¨×¢×” ×©×’×™××”, ×× × × ×¡×” ×©×•×‘.",
        loginInvalidCode: "×§×•×“ ×©×’×•×™ ××• ×©×¤×’ ×ª×•×§×¤×•.",
        loginPhoneRequired: "×× × ×”×–×Ÿ ××¡×¤×¨ ×˜×œ×¤×•×Ÿ.",
        loginCodeRequired: "×× × ×”×–×Ÿ ××ª ×§×•×“ ×”××™××•×ª."
      }
    };

    function switchLang(lang) {
      if (lang === 'en') {
        document.documentElement.lang = 'en';
        document.documentElement.dir = 'ltr';
      } else {
        document.documentElement.lang = lang;
        document.documentElement.dir = 'rtl';
      }
      document.querySelectorAll('[data-key]').forEach(el => {
        const key = el.getAttribute('data-key');
        if (translations[lang] && translations[lang][key]) {
          el.textContent = translations[lang][key];
        }
      });
    }

    function openBookingModal() {
      document.getElementById('booking-modal').style.display = 'block';
    }
    function closeBookingModal() {
      document.getElementById('booking-modal').style.display = 'none';
    }

    function openLoginModal() {
      document.getElementById('login-modal').style.display = 'block';
      document.getElementById('login-step1').style.display = 'block';
      document.getElementById('login-step2').style.display = 'none';
      document.getElementById('login-message').textContent = '';
      document.getElementById('login-phone').value = '';
      document.getElementById('login-code').value = '';
      document.getElementById('login-email-input').value = '';
      document.getElementById('login-password-input').value = '';
    }
    function closeLoginModal() {
      document.getElementById('login-modal').style.display = 'none';
    }

    function toggleProfileDropdown() {
      const dropdown = document.getElementById('profile-dropdown');
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }

    function logout() {
      localStorage.removeItem('loggedInPhone');
      updateUIForLogin(false);
      toggleProfileDropdown();
      alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬');
      firebase.auth().signOut();
    }

    function updateUIForLogin(isLoggedIn) {
      const profileIcon = document.getElementById('profile-link');
      const loginBtn = document.getElementById('login-btn');
      if (isLoggedIn) {
        profileIcon.style.display = 'block';
        loginBtn.style.display = 'none';
      } else {
        profileIcon.style.display = 'none';
        loginBtn.style.display = 'inline-block';
      }
    }

    // --- Firebase Phone Auth ---
    async function requestLoginCode() {
      const phoneInput = document.getElementById('login-phone');
      const phone = phoneInput.value.trim();
      const msg = document.getElementById('login-message');
      msg.style.color = 'red';

      // Validate E.164 format
      if (!phone || !/^\+\d{10,15}$/.test(phone)) {
        msg.textContent = "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø¯ÙˆÙ„ÙŠ ØµØ­ÙŠØ­ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ +";
        return;
      }

      // Setup reCAPTCHA
      if (!window.recaptchaVerifier) {
        window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
          size: 'invisible'
        });
      }

      try {
        confirmationResult = await firebase.auth().signInWithPhoneNumber(phone, window.recaptchaVerifier);
        msg.style.color = 'green';
        msg.textContent = translations[getCurrentLang()].loginCodeSent;
        document.getElementById('login-step1').style.display = 'none';
        document.getElementById('login-step2').style.display = 'block';
      } catch (error) {
        msg.textContent = error.message || translations[getCurrentLang()].loginError;
      }
    }

    async function verifyLoginCode() {
      const code = document.getElementById('login-code').value.trim();
      const msg = document.getElementById('login-message');
      msg.style.color = 'red';

      if (!code) {
        msg.textContent = translations[getCurrentLang()].loginCodeRequired;
        return;
      }

      try {
        const result = await confirmationResult.confirm(code);
        msg.style.color = 'green';
        msg.textContent = translations[getCurrentLang()].loginSuccess;
        localStorage.setItem('loggedInPhone', result.user.phoneNumber);
        updateUIForLogin(true);
        setTimeout(() => {
          closeLoginModal();
          msg.textContent = '';
        }, 1500);
      } catch (error) {
        msg.textContent = error.message || translations[getCurrentLang()].loginInvalidCode;
      }
    }

    // --- Firebase Email/Password Auth ---
    async function emailLogin() {
      const email = document.getElementById('login-email-input').value.trim();
      const password = document.getElementById('login-password-input').value.trim();
      const msg = document.getElementById('login-message');
      msg.style.color = 'red';

      if (!email || !password) {
        msg.textContent = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±';
        return;
      }

      try {
        const userCredential = await firebase.auth().signInWithEmailAndPassword(email, password);
        msg.style.color = 'green';
        msg.textContent = 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯!';
        localStorage.setItem('loggedInPhone', userCredential.user.email);
        updateUIForLogin(true);
        setTimeout(() => {
          closeLoginModal();
          msg.textContent = '';
        }, 1500);
      } catch (error) {
        msg.textContent = error.message;
      }
    }

    async function emailRegister() {
      const email = document.getElementById('login-email-input').value.trim();
      const password = document.getElementById('login-password-input').value.trim();
      const msg = document.getElementById('login-message');
      msg.style.color = 'red';

      if (!email || !password) {
        msg.textContent = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±';
        return;
      }

      try {
        const userCredential = await firebase.auth().createUserWithEmailAndPassword(email, password);
        msg.style.color = 'green';
        msg.textContent = 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„!';
        localStorage.setItem('loggedInPhone', userCredential.user.email);
        updateUIForLogin(true);
        setTimeout(() => {
          closeLoginModal();
          msg.textContent = '';
        }, 1500);
      } catch (error) {
        if (error.code === 'auth/email-already-in-use') {
          msg.textContent = 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„. Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯.';
        } else {
          msg.textContent = error.message;
        }
      }
    }

    function getCurrentLang() {
      return document.documentElement.lang || 'ar';
    }

    window.onload = () => {
      switchLang(getCurrentLang());
      const loggedInPhone = localStorage.getItem('loggedInPhone');
      updateUIForLogin(!!loggedInPhone);
    };

    window.onclick = function(event) {
      const bookingModal = document.getElementById('booking-modal');
      const loginModal = document.getElementById('login-modal');
      if (event.target === bookingModal) {
        closeBookingModal();
      }
      if (event.target === loginModal) {
        closeLoginModal();
      }
    };

    document.getElementById('booking-form').addEventListener('submit', async function(e) {
      e.preventDefault();

      const phone = localStorage.getItem('loggedInPhone');
      const pickup = document.getElementById('pickup-input').value.trim();
      const destination = document.getElementById('destination-input').value.trim();
      const rideType = document.getElementById('ride-type-input').value;

      if (!phone) {
        alert('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
        return;
      }

      if (!pickup || !destination || !rideType) {
        alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
        return;
      }

      try {
        const res = await fetch('/log-ride', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ phone, pickup, destination, rideType })
        });
        const data = await res.json();

        if (res.ok) {
          alert('ØªÙ… Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­!');
          closeBookingModal();
        } else {
          alert(data.message || 'ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø­Ø¬Ø²');
        }
      } catch (err) {
        console.error(err);
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø¬Ø²');
      }
    });
  </script>

</body>
</html>